<div class="headrow">
  <h2 class="page-title">Ligas</h2>
  <button class="btnx" type="button" (click)="openCreate()">
    <i class="bi bi-plus-lg"></i> Nueva liga
  </button>
</div>

<div class="cardx">
  <div *ngIf="loading">Cargando...</div>
  <div *ngIf="error" class="alertx">{{ error }}</div>

  <table *ngIf="!loading && !error" class="tablex">
    <thead>
      <tr>
        <th style="width:90px">ID</th>
        <th>Nombre</th>
        <th>Categoría</th>
        <th>Descripción</th>
        <th style="width:180px; text-align:right">Acciones</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let l of ligas">
        <td>#{{ l.id }}</td>
        <td><b>{{ l.nombre }}</b></td>
        <td>{{ l.categoria }}</td>
        <td>{{ l.descripcion }}</td>
        <td>
          <div class="actions">
            <button class="iconact" type="button" title="Editar" (click)="openEdit(l)">
              <i class="bi bi-pencil"></i>
            </button>
            <button class="iconact" type="button" title="Eliminar" (click)="openDelete(l)">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="backdrop" *ngIf="modal !== 'none'" (click)="closeModal()"></div>

<div class="modalx" *ngIf="modal !== 'none'">
  <div class="modal-card" (click)="$event.stopPropagation()">
    <div class="modal-head">
      <div class="modal-title">{{ modal === 'create' ? 'Nueva Liga' : modal === 'edit' ? 'Editar Liga' : 'Eliminar Liga' }}</div>
      <button class="xbtn" type="button" (click)="closeModal()">✕</button>
    </div>

    <form *ngIf="modal==='create' || modal==='edit'" [formGroup]="form" (ngSubmit)="save()">
      <div class="grid2">
        <div>
          <label class="lbl">Nombre</label>
          <input class="inp" formControlName="nombre" placeholder="Liga Municipal..." />
        </div>
        <div>
          <label class="lbl">Categoría</label>
          <input class="inp" formControlName="categoria" placeholder="Varonil, Femenil..." />
        </div>
        <div class="span2">
          <label class="lbl">Descripción</label>
          <input class="inp" formControlName="descripcion" placeholder="Descripción corta..." />
        </div>
      </div>

      <div class="modal-actions">
        <button class="btnlite" type="button" (click)="closeModal()">Cancelar</button>
        <button class="btnx" type="submit" [disabled]="saving">{{ saving ? 'Guardando...' : 'Guardar' }}</button>
      </div>
    </form>

    <div *ngIf="modal==='confirmDelete'">
      <p>¿Eliminar la liga <b>#{{ selected?.id }}</b> <span class="muted">{{ selected?.nombre }}</span>?</p>
      <div class="modal-actions">
        <button class="btnlite" type="button" (click)="closeModal()">Cancelar</button>
        <button class="btndanger" type="button" [disabled]="saving" (click)="doDelete()">
          {{ saving ? 'Eliminando...' : 'Eliminar' }}
        </button>
      </div>
    </div>
  </div>
</div>
